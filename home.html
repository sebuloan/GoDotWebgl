<!DOCTYPE html>
<html>
<head>
    <title>Parent Page with Godot Iframe</title>
</head>
<body>
    <button onclick="callGodot()">Call Godot Function</button>
    <iframe id="godot-game" src=" https://sebuloan.github.io/GoDotWebgl/index.html"></iframe>

    <!-- Add the script here -->
    <script>
    async function callGodot() {
        try {
            const iframe = document.getElementById('godot-game');
            const godotWindow = iframe.contentWindow;

            // Wait for Godot to load inside the iframe
            await new Promise(resolve => {
                if (godotWindow.Engine && godotWindow.Engine.isWebGLLoaded()) {
                    resolve();
                } else {
                    godotWindow.addEventListener('godot-loaded', resolve);
                }
            });

            // Get the engine instance from the iframe
            const engine = await godotWindow.Engine.getInstance();
            
            // Call the Godot function
            const response = await engine.greetFromJs("Web User");
            alert(response);
            
        } catch (error) {
            console.error("Error calling Godot:", error);
        }
    }
    </script>
</body>
</html>
